
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>1.2. Double Pipe Heat Exchanger &#8212; CBE 31358 Laboratory I</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="1.3. Heat Transfer Coeffient Model" href="03_heat-transfer-model.html" />
    <link rel="prev" title="1.1. Introduction to Heat Exchangers" href="01_introduction-to-hx.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">CBE 31358 Laboratory I</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../intro.html">
   CBE 31358 Chemical Engineering Lab I
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Experiments
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="00_hx.html">
   1. Heat Exchanger Experiment
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="01_introduction-to-hx.html">
     1.1. Introduction to Heat Exchangers
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     1.2. Double Pipe Heat Exchanger
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_heat-transfer-model.html">
     1.3. Heat Transfer Coeffient Model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="04_reports.html">
     1.4. Reports
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Methods
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../methods/05-Tidy-Data-and-Pandas.html">
   1. Tidy Data and Pandas
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/notebooks/01/02_double-pipe-hx.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/jckantor/cbe31358-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/jckantor/cbe31358-book/issues/new?title=Issue%20on%20page%20%2Fnotebooks/01/02_double-pipe-hx.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/jckantor/cbe31358-book/main?urlpath=lab/tree/notebooks/01/02_double-pipe-hx.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/jckantor/cbe31358-book/blob/main/notebooks/01/02_double-pipe-hx.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#experimental-goals">
   1.2.1. Experimental Goals
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#co-current-operation">
   1.2.2. Co-Current Operation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rating-calculations">
     1.2.2.1. Rating Calculations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#measuring-heat-transfer-coefficient">
     1.2.2.2. Measuring Heat Transfer Coefficient
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rating-revisited">
     1.2.2.3. Rating, revisited
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#counter-current-operation">
   1.2.3. Counter-Current Operation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     1.2.3.1. Rating Calculations
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Double Pipe Heat Exchanger</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#experimental-goals">
   1.2.1. Experimental Goals
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#co-current-operation">
   1.2.2. Co-Current Operation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rating-calculations">
     1.2.2.1. Rating Calculations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#measuring-heat-transfer-coefficient">
     1.2.2.2. Measuring Heat Transfer Coefficient
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rating-revisited">
     1.2.2.3. Rating, revisited
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#counter-current-operation">
   1.2.3. Counter-Current Operation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     1.2.3.1. Rating Calculations
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="double-pipe-heat-exchanger">
<h1><span class="section-number">1.2. </span>Double Pipe Heat Exchanger<a class="headerlink" href="#double-pipe-heat-exchanger" title="Permalink to this headline">¶</a></h1>
<div class="section" id="experimental-goals">
<h2><span class="section-number">1.2.1. </span>Experimental Goals<a class="headerlink" href="#experimental-goals" title="Permalink to this headline">¶</a></h2>
<p>There are three basic calculations for heat exchanger design.</p>
<ul class="simple">
<li><p><strong>Rating.</strong> Given the size, geometry, entering flowrates and streaam temperatures, compute the heat transferred.</p></li>
<li><p><strong>Performance.</strong> Given measurements of stream flowrates and temperatures, estimate the heat transfer coefficient.</p></li>
<li><p><strong>Sizing.</strong> Given the heat transfer requirements and stream flowrates, compute the required size and other design parameters. Sizing calculations generally require consideration of heat exchanger geometry, economics, and is considerably more complex thaan rating or performance calculations.</p></li>
</ul>
<p>In this experiment, you will conduct experiments and gather data needed characterize heat exchanger performance to create a preditive model for rating calculations. You will then test your models ability to predict heat exchanger performance for other operating conditions.</p>
</div>
<div class="section" id="co-current-operation">
<h2><span class="section-number">1.2.2. </span>Co-Current Operation<a class="headerlink" href="#co-current-operation" title="Permalink to this headline">¶</a></h2>
<div class="section" id="rating-calculations">
<h3><span class="section-number">1.2.2.1. </span>Rating Calculations<a class="headerlink" href="#rating-calculations" title="Permalink to this headline">¶</a></h3>
<p>Consider a heat exchanger in a co-current configuration. Label one end <span class="math notranslate nohighlight">\(z=0\)</span> and the other <span class="math notranslate nohighlight">\(z=1\)</span>. <span class="math notranslate nohighlight">\(z\)</span> changes continuously from 0 to 1 over the length of the heat exchanger. If the cross-sectional for heat transfer is constant then</p>
<div class="math notranslate nohighlight">
\[dA = A dz\]</div>
<p>where <span class="math notranslate nohighlight">\(A\)</span> is the total area for heat transfer. According to the Second Law of Thermodynamics, heat transfers from the hot stream to the cold stream. A model for differential amount of heat transferred, <span class="math notranslate nohighlight">\(dQ\)</span> over a length <span class="math notranslate nohighlight">\(dz\)</span> is</p>
<div class="math notranslate nohighlight">
\[dQ = UA (T_h - T_c) dz\]</div>
<p>where the temperture difference <span class="math notranslate nohighlight">\(T_h - T_c\)</span> is the driving force for heat transfer.</p>
<p>In a co-current configuration, let <span class="math notranslate nohighlight">\(\dot{m}_h\)</span> and <span class="math notranslate nohighlight">\(\dot{m}_c\)</span> denote flow in the positive <span class="math notranslate nohighlight">\(z\)</span> direction. Heat transfer results in a cooling of the hot stream and a waarming of the cold stream relative to the same direction.</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
-\dot{m}_h C_{p,h} dT_h &amp; = dQ \\
\dot{m}_c C_{p,c} dT_c &amp; = dQ
\end{align*}\]</div>
<p>In co-current operation the temperature of both inlet flows are known at <span class="math notranslate nohighlight">\(z=0\)</span>. After substitution for <span class="math notranslate nohighlight">\(dQ\)</span>, the temperature profile is  given by a pair of first order differential equations with  initial conditions for <span class="math notranslate nohighlight">\(T_h(0)\)</span> and <span class="math notranslate nohighlight">\(T_c(0)\)</span></p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\frac{dT_h}{dz} &amp; = -\frac{UA}{\dot{m}_hC_{p,h}}(T_h - T_c)  &amp; T_h(z=0) = T_{h,0}\\
\frac{dT_c}{dz} &amp; = \frac{UA}{\dot{m}_cC_{p,c}}(T_h - T_c) &amp; T_c(z=0) = T_{c, 0}
\end{align*}\]</div>
<p>This is an initial value problem of two differential equations that can be solved numerically with <code class="docutils literal notranslate"><span class="pre">scipy.integrate.solve_ivp</span></code> as demonstrated below.</p>
<p>The results of the temperature calculation can be used to complete the rating calculation.</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
Q_h &amp; = \dot{m}_h C_{p,h} (T_{h,0} - T_{h,1}) \\
Q_c &amp; = \dot{m}_c C_{p,c} (T_{c,1} - T_{c,0})
\end{align*}\]</div>
<p>where we expect <span class="math notranslate nohighlight">\(Q = Q_h = Q_c\)</span> at steady state and with negligible heat losses.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">solve_ivp</span>

<span class="c1"># parameter values</span>
<span class="n">A</span> <span class="o">=</span> <span class="mf">0.5</span>       <span class="c1"># square meters</span>
<span class="n">U</span> <span class="o">=</span> <span class="mi">2000</span>      <span class="c1"># watts/square meter/deg C</span>
<span class="n">mh</span> <span class="o">=</span> <span class="mi">600</span>      <span class="c1"># kg/hour</span>
<span class="n">mc</span> <span class="o">=</span> <span class="mi">1200</span>     <span class="c1"># kg/hour</span>
<span class="n">Cp</span> <span class="o">=</span> <span class="mi">4184</span>     <span class="c1"># Joules/kg/deg C     </span>

<span class="c1"># feed temperatures</span>
<span class="n">Th0</span> <span class="o">=</span> <span class="mf">55.0</span>
<span class="n">Tc0</span> <span class="o">=</span> <span class="mf">18.0</span>

<span class="c1"># differential equation model</span>
<span class="k">def</span> <span class="nf">deriv</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">Th</span><span class="p">,</span> <span class="n">Tc</span> <span class="o">=</span> <span class="n">y</span>
    <span class="n">dTh</span> <span class="o">=</span> <span class="o">-</span><span class="n">U</span><span class="o">*</span><span class="n">A</span><span class="o">*</span><span class="p">(</span><span class="n">Th</span> <span class="o">-</span> <span class="n">Tc</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">mh</span><span class="o">/</span><span class="mi">3600</span><span class="p">)</span><span class="o">*</span><span class="n">Cp</span><span class="p">)</span>
    <span class="n">dTc</span> <span class="o">=</span>  <span class="n">U</span><span class="o">*</span><span class="n">A</span><span class="o">*</span><span class="p">(</span><span class="n">Th</span><span class="o">-</span><span class="n">Tc</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">mc</span><span class="o">/</span><span class="mi">3600</span><span class="p">)</span><span class="o">*</span><span class="n">Cp</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">dTh</span><span class="p">,</span> <span class="n">dTc</span><span class="p">]</span>

<span class="c1"># initial conditions</span>
<span class="n">IC</span> <span class="o">=</span> <span class="p">[</span><span class="n">Th0</span><span class="p">,</span> <span class="n">Tc0</span><span class="p">]</span>

<span class="c1"># evaluate solution</span>
<span class="n">soln</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">deriv</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">IC</span><span class="p">,</span> <span class="n">max_step</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>

<span class="c1"># plot solution</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">soln</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Th&quot;</span><span class="p">,</span> <span class="s2">&quot;Tc&quot;</span><span class="p">])</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;z&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">soln</span><span class="o">.</span><span class="n">t</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;z&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Th&quot;</span> <span class="p">:</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="s2">&quot;Tc&quot;</span> <span class="p">:</span> <span class="s2">&quot;b&quot;</span><span class="p">},</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Co-current Heat Exchanger&quot;</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;distance&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;deg C&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Th&quot;</span><span class="p">],</span> <span class="s1">&#39;r.&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Tc&quot;</span><span class="p">],</span> <span class="s1">&#39;b.&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7faa18108f10&gt;]
</pre></div>
</div>
<img alt="../../_images/02_double-pipe-hx_3_1.png" src="../../_images/02_double-pipe-hx_3_1.png" />
</div>
</div>
</div>
<div class="section" id="measuring-heat-transfer-coefficient">
<h3><span class="section-number">1.2.2.2. </span>Measuring Heat Transfer Coefficient<a class="headerlink" href="#measuring-heat-transfer-coefficient" title="Permalink to this headline">¶</a></h3>
<p>An analytical solution for the difference <span class="math notranslate nohighlight">\(T_h - T_c\)</span> is possible for this system of equations. Subtracting the second equation from the first gives</p>
<div class="math notranslate nohighlight">
\[\frac{d(T_h - T_c)}{dz} = -UA\left(\frac{1}{\dot{m}_hC_{p,h}} + \frac{1}{\dot{m}_cC_{p,c}}\right) (T_h - T_c)\]</div>
<p>This is a first-order linear differentiaal equation with constant coefficients that can be solved by a separation of variables. One form of the solution is</p>
<div class="math notranslate nohighlight">
\[\ln \frac{T_h - T_c}{T_{h,0} - T_{c,0}} = -UA\left(\frac{1}{\dot{m}_hC_{p,h}} + \frac{1}{\dot{m}_cC_{p,c}}\right)z\]</div>
<p>where <span class="math notranslate nohighlight">\(T_h\)</span> and <span class="math notranslate nohighlight">\(T_c\)</span> are functions of <span class="math notranslate nohighlight">\(z\)</span> on the interval <span class="math notranslate nohighlight">\(0 \leq z \leq 1\)</span>.</p>
<p>An overall balance for the total heat transferred between the hot and cold streams is given by</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
Q_h &amp; = \dot{m}_h C_{p,h} (T_{h,0} - T_{h,1}) \\
Q_c &amp; = \dot{m}_c C_{p,c} (T_{c,1} - T_{c,0})
\end{align*}\]</div>
<p>Rearranging</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\frac{1}{\dot{m}_hC_{p,h}} &amp; = \frac{T_{h,0} - T_{h,1}}{Q_h} \\
\frac{1}{\dot{m}_cC_{p,c}} &amp; = \frac{T_{c,1} - T_{c,0}}{Q_c}
\end{align*}\]</div>
<p>At steady-state <span class="math notranslate nohighlight">\(Q_h = Q_c\)</span>. With a little more algebra this leaves</p>
<div class="math notranslate nohighlight">
\[Q = UA \frac{(T_{h,1} - T_{c,1}) - (T_{h,0} - T_{c,0})}{\ln \frac{T_{h,1} - T_{c,1}}{T_{h,0} - T_{c,0}}}\]</div>
<p>The temperature dependent term multiplying <span class="math notranslate nohighlight">\(UA\)</span> is call the <strong>log mean temperature difference</strong>.</p>
<div class="math notranslate nohighlight">
\[\text{LMTD} = \frac{(T_{h,1} - T_{c,1}) - (T_{h,0} - T_{c,0})}{\ln \frac{T_{h,1} - T_{c,1}}{T_{h,0} - T_{c,0}}}\]</div>
<p>Given experimental data, these relationships can be used to estimate the heat transfer coefficient <span class="math notranslate nohighlight">\(U\)</span> from steady-state measurements of inlet and outlet temperataures and heat duty.</p>
<div class="math notranslate nohighlight">
\[U = \frac{Q}{A \cdot \text{LMTD}}\]</div>
<p>The following code provides estimates the value of <span class="math notranslate nohighlight">\(U\)</span> from experimental data in two steps. The first step uses the temperatures measured at both ends of the exchanger and the measured heat duty to compute the LMTD and <span class="math notranslate nohighlight">\(U\)</span>. The second step refines the estimate by fitting a model to the experimental results.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">solve_ivp</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">fmin</span>

<span class="c1"># known parameter values</span>
<span class="n">A</span> <span class="o">=</span> <span class="mf">5.0</span>
<span class="n">mh</span> <span class="o">=</span> <span class="mi">600</span>
<span class="n">mc</span> <span class="o">=</span> <span class="mi">1200</span>
<span class="n">Cp</span> <span class="o">=</span> <span class="mf">4.0</span>

<span class="c1"># experimental data</span>
<span class="n">z_expt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">Th_expt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">55.0</span><span class="p">,</span> <span class="mf">48.0</span><span class="p">,</span> <span class="mf">42.0</span><span class="p">,</span> <span class="mf">38.0</span><span class="p">,</span> <span class="mf">33.0</span><span class="p">])</span>
<span class="n">Tc_expt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">18.0</span><span class="p">,</span> <span class="mf">22.0</span><span class="p">,</span> <span class="mf">25.0</span><span class="p">,</span> <span class="mf">28.0</span><span class="p">,</span> <span class="mf">29.0</span><span class="p">])</span>

<span class="c1"># LMTD calculation of heat transfer coefficient</span>
<span class="n">Th0</span><span class="p">,</span> <span class="n">Th1</span> <span class="o">=</span> <span class="n">Th_expt</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Th_expt</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">Tc0</span><span class="p">,</span> <span class="n">Tc1</span> <span class="o">=</span> <span class="n">Tc_expt</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Tc_expt</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># compute heat duty</span>
<span class="n">Qh</span> <span class="o">=</span> <span class="n">mh</span><span class="o">*</span><span class="n">Cp</span><span class="o">*</span><span class="p">(</span><span class="n">Th0</span> <span class="o">-</span> <span class="n">Th1</span><span class="p">)</span>
<span class="n">Qc</span> <span class="o">=</span> <span class="n">mc</span><span class="o">*</span><span class="n">Cp</span><span class="o">*</span><span class="p">(</span><span class="n">Tc1</span> <span class="o">-</span> <span class="n">Tc0</span><span class="p">)</span>
<span class="n">Q</span> <span class="o">=</span> <span class="p">(</span><span class="n">Qh</span> <span class="o">+</span> <span class="n">Qc</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Heat duty = </span><span class="si">{</span><span class="n">Q</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> watts&quot;</span><span class="p">)</span>

<span class="c1"># compute number of transfer units</span>
<span class="n">NTU</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">Th1</span> <span class="o">-</span> <span class="n">Tc1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">Th0</span> <span class="o">-</span> <span class="n">Th1</span><span class="p">))</span>

<span class="c1"># estimate heat transfer coefficient</span>
<span class="n">LMTD</span> <span class="o">=</span> <span class="p">((</span><span class="n">Th1</span> <span class="o">-</span> <span class="n">Tc1</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">Th0</span> <span class="o">-</span> <span class="n">Tc0</span><span class="p">))</span><span class="o">/</span><span class="n">NTU</span>
<span class="n">U</span> <span class="o">=</span> <span class="n">Q</span> <span class="o">/</span> <span class="p">(</span><span class="n">LMTD</span> <span class="o">*</span> <span class="n">A</span><span class="p">)</span>

<span class="c1"># display results</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;NTU = </span><span class="si">{</span><span class="o">-</span><span class="n">NTU</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;LMTD = </span><span class="si">{</span><span class="n">LMTD</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> deg C&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;U (LMTD estimate) = </span><span class="si">{</span><span class="n">U</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> watt/deg C/m**2&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Heat duty = 52800.0 watts
NTU = 1.70
LMTD = 19.36 deg C
U (LMTD estimate) = 545.5 watt/deg C/m**2
</pre></div>
</div>
</div>
</div>
<p>Fitting temperature profiles</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># initial estimate of fitted parameters</span>
<span class="n">p_estimate</span> <span class="o">=</span> <span class="p">[</span><span class="n">U</span><span class="p">,</span> <span class="n">Th0</span><span class="p">,</span> <span class="n">Tc0</span><span class="p">]</span>

<span class="c1"># simulate double pipe heat exchange given parameter vector p</span>
<span class="k">def</span> <span class="nf">double_pipe_cocurrent</span><span class="p">(</span><span class="n">z_eval</span><span class="p">,</span> <span class="n">parameters</span><span class="p">):</span>
    <span class="n">U</span><span class="p">,</span> <span class="n">Th0</span><span class="p">,</span> <span class="n">Tc0</span> <span class="o">=</span> <span class="n">parameters</span>
    <span class="k">def</span> <span class="nf">deriv</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="n">Th</span><span class="p">,</span> <span class="n">Tc</span> <span class="o">=</span> <span class="n">y</span>
        <span class="k">return</span> <span class="p">[</span><span class="o">-</span><span class="n">U</span><span class="o">*</span><span class="n">A</span><span class="o">*</span><span class="p">(</span><span class="n">Th</span> <span class="o">-</span> <span class="n">Tc</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mh</span><span class="o">*</span><span class="n">Cp</span><span class="p">),</span> <span class="n">U</span><span class="o">*</span><span class="n">A</span><span class="o">*</span><span class="p">(</span><span class="n">Th</span><span class="o">-</span><span class="n">Tc</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mc</span><span class="o">*</span><span class="n">Cp</span><span class="p">)]</span>
    <span class="n">soln</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">deriv</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="n">Th0</span><span class="p">,</span> <span class="n">Tc0</span><span class="p">],</span> <span class="n">t_eval</span><span class="o">=</span><span class="n">z_eval</span><span class="p">,</span> <span class="n">max_step</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
    <span class="n">Th</span> <span class="o">=</span> <span class="n">soln</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span>
    <span class="n">Tc</span> <span class="o">=</span> <span class="n">soln</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span>
    <span class="k">return</span> <span class="n">Th</span><span class="p">,</span> <span class="n">Tc</span>
 
<span class="c1"># compute residuals between experiment and model</span>
<span class="k">def</span> <span class="nf">residuals</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="n">Th_pred</span><span class="p">,</span> <span class="n">Tc_pred</span> <span class="o">=</span> <span class="n">double_pipe_cocurrent</span><span class="p">(</span><span class="n">z_expt</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">((</span><span class="n">Th_expt</span> <span class="o">-</span> <span class="n">Th_pred</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="nb">sum</span><span class="p">((</span><span class="n">Tc_expt</span> <span class="o">-</span> <span class="n">Tc_pred</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># minimize residuals</span>
<span class="n">p_min</span> <span class="o">=</span> <span class="n">fmin</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">p_estimate</span><span class="p">)</span>
<span class="n">U_min</span> <span class="o">=</span> <span class="n">p_min</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;U (model fit) = </span><span class="si">{</span><span class="n">U_min</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> watt/deg C/m**2&quot;</span><span class="p">)</span>

<span class="c1"># compute temperature profile using the best least squares fit</span>
<span class="n">z_eval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">201</span><span class="p">)</span>
<span class="n">Th_pred</span><span class="p">,</span> <span class="n">Tc_pred</span> <span class="o">=</span> <span class="n">double_pipe_cocurrent</span><span class="p">(</span><span class="n">z_eval</span><span class="p">,</span> <span class="n">p_min</span><span class="p">)</span>

<span class="c1"># plot solution</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z_eval</span><span class="p">,</span> <span class="n">Th_pred</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;T_h&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z_eval</span><span class="p">,</span> <span class="n">Tc_pred</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;T_c&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z_expt</span><span class="p">,</span> <span class="n">Th_expt</span><span class="p">,</span> <span class="s1">&#39;r.&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z_expt</span><span class="p">,</span> <span class="n">Tc_expt</span><span class="p">,</span> <span class="s1">&#39;b.&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;fractional distance z&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;deg C&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Co-current Heat Exchanger: U = </span><span class="si">{</span><span class="n">U_min</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> watts/deg/m**2&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Heat duty = 52800.0 watts
NTU = 1.70
LMTD = 19.36 deg C
U (LMTD estimate) = 545.5 watt/deg C/m**2
Optimization terminated successfully.
         Current function value: 8.273495
         Iterations: 75
         Function evaluations: 141
U (model fit) = 554.4 watt/deg C/m**2
</pre></div>
</div>
<img alt="../../_images/02_double-pipe-hx_8_1.png" src="../../_images/02_double-pipe-hx_8_1.png" />
</div>
</div>
</div>
<div class="section" id="rating-revisited">
<h3><span class="section-number">1.2.2.3. </span>Rating, revisited<a class="headerlink" href="#rating-revisited" title="Permalink to this headline">¶</a></h3>
<p>Integrating</p>
<div class="math notranslate nohighlight">
\[dQ = UA (T_h - T_c) dz\]</div>
<p>So that</p>
<div class="math notranslate nohighlight">
\[Q = UA \int_0^1 (T_h(z) - T_c(z)) dz\]</div>
<p>We have a solution for the difference <span class="math notranslate nohighlight">\(T_h(z) - T_c(z)\)</span> that can be written</p>
<div class="math notranslate nohighlight">
\[T_h(z) - T_c(z) = (T_{h,0} - T_{c,0}) \exp\left(-UA\left(\frac{1}{\dot{m}_hC_{p,h}} + \frac{1}{\dot{m}_cC_{p,c}}\right)z\right)\]</div>
<p>Performing the integrations produces a rating equation</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
Q &amp; = UA(T_{h,0} - T_{c,0}) \int_0^1 \exp\left(-UA\left(\frac{1}{\dot{m}_hC_{p,h}} + \frac{1}{\dot{m}_cC_{p,c}}\right)z\right)dz \\
&amp; = -\frac{T_{h,0} - T_{c,0}}{\frac{1}{\dot{m}_hC_{p,h}} + \frac{1}{\dot{m}_cC_{p,c}}}\left[\exp\left(-UA\left(\frac{1}{\dot{m}_hC_{p,h}} + \frac{1}{\dot{m}_cC_{p,c}}\right)z\right)\right]\biggr\rvert_0^1 \\
\end{align*}\]</div>
<p>which provides a solution</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\implies Q &amp; = \frac{T_{h,0} - T_{c,0}}{\frac{1}{\dot{m}_hC_{p,h}} + \frac{1}{\dot{m}_cC_{p,c}}}\left[1 - \exp\left(-UA\left(\frac{1}{\dot{m}_hC_{p,h}} + \frac{1}{\dot{m}_cC_{p,c}}\right)\right)\right]
\end{align*}\]</div>
<p>This is an equation that predicts the heat transfer in terms of the known stream input temperatures and flowrates.</p>
</div>
</div>
<div class="section" id="counter-current-operation">
<h2><span class="section-number">1.2.3. </span>Counter-Current Operation<a class="headerlink" href="#counter-current-operation" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id1">
<h3><span class="section-number">1.2.3.1. </span>Rating Calculations<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>Counter-current operation requires a different method of solution. For this case we will assume the cold water stream enters at <span class="math notranslate nohighlight">\(z=0\)</span> while the hot stream enters at <span class="math notranslate nohighlight">\(z=1\)</span>. As before, heat is transferred from the hot stream to the cold stream</p>
<div class="math notranslate nohighlight">
\[dQ = UA (T_h - T_c) dz\]</div>
<p>Because of the counter-current flow, <span class="math notranslate nohighlight">\(T_h\)</span> and <span class="math notranslate nohighlight">\(T_c\)</span> both increase in the direction of increasaing <span class="math notranslate nohighlight">\(z\)</span></p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\dot{m}_h C_{p,h} dT_h &amp; = dQ \\
\dot{m}_c C_{p,c} dT_c &amp; = dQ
\end{align*}\]</div>
<p>Substitution yields</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\frac{dT_h}{dz} &amp; = \frac{UA}{\dot{m}_hC_{p,h}}(T_h - T_c) &amp; T_h(z=1) = T_{h,1} \\
\frac{dT_c}{dz} &amp; = \frac{UA}{\dot{m}_cC_{p,c}}(T_h - T_c) &amp; T_c(z=0) = T_{c,0}
\end{align*}\]</div>
<p>where <span class="math notranslate nohighlight">\(T_c(0)\)</span> and <span class="math notranslate nohighlight">\(T_h(1)\)</span> are specified at opposite ends of the heat exchanger. For this reason, these equations for the counter-current heat exchanger comprise a two point boundary value problem.</p>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.solve_bvp.html"><code class="docutils literal notranslate"><span class="pre">scipy.integrate.solve_bvp</span></code></a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">solve_bvp</span>

<span class="c1"># parameter values</span>
<span class="n">A</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">U</span> <span class="o">=</span> <span class="mi">700</span>
<span class="n">mh</span> <span class="o">=</span> <span class="mi">600</span>
<span class="n">mc</span> <span class="o">=</span> <span class="mi">1200</span>
<span class="n">Cp</span> <span class="o">=</span> <span class="mf">4.0</span>

<span class="c1"># feed temperatures</span>
<span class="n">Th1</span> <span class="o">=</span> <span class="mf">55.0</span>
<span class="n">Tc0</span> <span class="o">=</span> <span class="mf">18.0</span>

<span class="c1"># number of points</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">201</span>

<span class="c1"># differential equation model</span>
<span class="k">def</span> <span class="nf">deriv</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">Th</span><span class="p">,</span> <span class="n">Tc</span> <span class="o">=</span> <span class="n">y</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">U</span><span class="o">*</span><span class="n">A</span><span class="o">*</span><span class="p">(</span><span class="n">Th</span> <span class="o">-</span> <span class="n">Tc</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mh</span><span class="o">*</span><span class="n">Cp</span><span class="p">),</span> <span class="n">U</span><span class="o">*</span><span class="n">A</span><span class="o">*</span><span class="p">(</span><span class="n">Th</span><span class="o">-</span><span class="n">Tc</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mc</span><span class="o">*</span><span class="n">Cp</span><span class="p">)]</span>

<span class="k">def</span> <span class="nf">bc</span><span class="p">(</span><span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">y1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">Th1</span><span class="p">,</span>  <span class="c1"># bc for Th at z=1</span>
            <span class="n">y0</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">Tc0</span><span class="p">]</span>  <span class="c1"># bc for Tc at z=0</span>

<span class="c1"># evaluate solution</span>
<span class="n">z_eval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">y_guess</span> <span class="o">=</span> <span class="p">(</span><span class="n">Th1</span> <span class="o">+</span> <span class="n">Tc0</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span>  <span class="c1"># initial guess</span>
<span class="n">soln</span> <span class="o">=</span> <span class="n">solve_bvp</span><span class="p">(</span><span class="n">deriv</span><span class="p">,</span> <span class="n">bc</span><span class="p">,</span> <span class="n">z_eval</span><span class="p">,</span> <span class="n">y_guess</span><span class="p">)</span>


<span class="c1"># plot solution</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">soln</span><span class="o">.</span><span class="n">x</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">soln</span><span class="o">.</span><span class="n">y</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;T_h&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">,:],</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;T_c&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Th1</span><span class="p">,</span> <span class="s1">&#39;r.&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Tc0</span><span class="p">,</span> <span class="s1">&#39;b.&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Distance&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;deg C&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/02_double-pipe-hx_11_0.png" src="../../_images/02_double-pipe-hx_11_0.png" />
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks/01"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="01_introduction-to-hx.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">1.1. </span>Introduction to Heat Exchangers</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="03_heat-transfer-model.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">1.3. </span>Heat Transfer Coeffient Model</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By ND-CBE Lab<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>